# ุฑุงูููุง ุชุณุช Firebase Phone Authentication

## โ ูพุงุฏูโุณุงุฒ ฺฉุงูู ุดุฏู ุงุณุช

ุณุณุชู ูุฑูุฏ ุจุง ุดูุงุฑู ููุจุงู ู OTP ุงุฒ ุทุฑู Firebase Authentication ุจู ุตูุฑุช ฺฉุงูู ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช.

## ๐ง ฺฉุงููฺฏ Firebase

ฺฉุงููฺฏ Firebase ุฏุฑ ูุงู `/app/driver/src/firebase.js` ุซุจุช ุดุฏู ุงุณุช:

```javascript
const firebaseConfig = {
  apiKey: "AIzaSyBqWEmIIngkoEjiAUKAcT3rvQGtsvCj3qc",
  authDomain: "snabb-82415.firebaseapp.com",
  projectId: "snabb-82415",
  storageBucket: "snabb-82415.firebasestorage.app",
  messagingSenderId: "1006448447805",
  appId: "1:1006448447805:web:c58b45899bcd67aa5d7554",
  measurementId: "G-V2JM77CH43"
};
```

## ๐ฑ ุดูุงุฑูโูุง ุชุณุช Firebase

| ุดูุงุฑู ููุจุงู        | ฺฉุฏ ุชุฃุฏ (OTP) |
|---------------------|----------------|
| +93 79 912 3456     | 123456         |
| +93 79 910 1112     | 123456         |
| +93 79 856 7909     | 123456         |

## ๐ ูุญูู ุงุฌุฑุง ู ุชุณุช

### 1. ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ Development

```bash
cd /app/driver
yarn start
```

ุณุฑูุฑ ุฑู ูพูุฑุช 3002 ุงุฌุฑุง ูโุดูุฏ: `http://localhost:3002`

### 2. ูุฑูุฏ ุจู ุตูุญู Login

ูุฑูุฑฺฏุฑ ุฎูุฏ ุฑุง ุจุงุฒ ฺฉูุฏ ู ุจู ุขุฏุฑุณ ุฒุฑ ุจุฑูุฏ:

```
http://localhost:3002/login
```

### 3. ูุฑุงุญู ุชุณุช ูุฑูุฏ ุจุง OTP

#### ูุฑุญูู 1: ูุงุฑุฏ ฺฉุฑุฏู ุดูุงุฑู ุชููู

1. ฺฉ ุงุฒ ุดูุงุฑูโูุง ุชุณุช ุฑุง ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู: `+93799123456`)
2. ูโุชูุงูุฏ ุจุฏูู `+93` ูู ูุงุฑุฏ ฺฉูุฏ (ูุซูุงู: `0799123456`)
3. ุฑู ุฏฺฉูู "ุฏุฑุงูุช ฺฉุฏ ุชุฃุฏ" ฺฉูฺฉ ฺฉูุฏ

#### ูุฑุญูู 2: ุชฺฉูู reCAPTCHA

- ุงฺฏุฑ reCAPTCHA ุจู ุตูุฑุช invisible ฺฉุงุฑ ฺฉูุฏุ OTP ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฑุณุงู ูโุดูุฏ
- ุงฺฏุฑ reCAPTCHA ุธุงูุฑ ุดูุฏุ ุชฺฉ "I'm not a robot" ุฑุง ุจุฒูุฏ

#### ูุฑุญูู 3: ูุงุฑุฏ ฺฉุฑุฏู ฺฉุฏ OTP

1. ุจุนุฏ ุงุฒ ุงุฑุณุงู ููููุ ููุฏ 6 ุฑูู ุจุฑุง ฺฉุฏ ุชุฃุฏ ุธุงูุฑ ูโุดูุฏ
2. ฺฉุฏ `123456` ุฑุง ูุงุฑุฏ ฺฉูุฏ
3. ุฑู ุฏฺฉูู "ุชุฃุฏ ู ูุฑูุฏ" ฺฉูฺฉ ฺฉูุฏ

#### ูุฑุญูู 4: ูุฑูุฏ ูููู

- ุจุนุฏ ุงุฒ ุชุฃุฏ OTPุ ุจู ุตูุญู ุงุตู Dashboard ููุชูู ูโุดูุฏ
- ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุฏุฑ localStorage ุฐุฎุฑู ูโุดูุฏ
- Firebase Authentication session ูุนุงู ูโุดูุฏ

## ๐ ุจุฑุฑุณ ูุถุนุช ุฏุฑ Developer Console

ุจุฑุง ุฏุฏู ูุงฺฏโูุง Firebase ู debug:

1. ฺฉูฺฉ ุฑุงุณุช โ Inspect โ Console
2. ูุดุงูุฏู ูพุงูโูุง Firebase:
   - "reCAPTCHA solved" - reCAPTCHA ุจุง ููููุช ุญู ุดุฏ
   - "Error sending OTP" - ุฎุทุง ุฏุฑ ุงุฑุณุงู OTP
   - "Error verifying OTP" - ุฎุทุง ุฏุฑ ุชุฃุฏ OTP

## ๐ ูุงูโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. `/app/driver/src/firebase.js`
- ฺฉุงููฺฏ Firebase
- Initialize Firebase App
- Export Firebase Auth

### 2. `/app/driver/src/context/AuthContext.js`
- ูพุงุฏูโุณุงุฒ ฺฉุงูู Firebase Phone Authentication
- `sendOTP()` - ุงุฑุณุงู OTP
- `verifyOTP()` - ุชุฃุฏ OTP
- `logout()` - ุฎุฑูุฌ ุงุฒ ุณุณุชู
- ูุฏุฑุช state ฺฉุงุฑุจุฑ ุจุง `onAuthStateChanged`

### 3. `/app/driver/src/pages/Login.js`
- UI ุตูุญู ูุฑูุฏ
- ุฏู ูุฑุญูู: ูุฑูุฏ ุดูุงุฑู ุชููู ู ุชุฃุฏ OTP
- `<div id="recaptcha-container">` ุจุฑุง reCAPTCHA
- ูุฏุฑุช ุฎุทุงูุง ู loading states

## โ๏ธ ูฺฺฏโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

โ Firebase Phone Authentication ุจุง SDK ุฌุฏุฏ  
โ Invisible reCAPTCHA  
โ ูุฑูุช ุฎูุฏฺฉุงุฑ ุดูุงุฑู ุชููู (ุงุถุงูู ฺฉุฑุฏู +93)  
โ ูุฏุฑุช ุฎุทุงูุง ู ููุงุด ูพุงูโูุง ูุงุฑุณ  
โ ุฐุฎุฑู session ุฏุฑ localStorage  
โ Auto-login ุจุนุฏ ุงุฒ refresh ุตูุญู  
โ ูพุดุชุจุงู ุงุฒ ุดูุงุฑูโูุง ุชุณุช Firebase  
โ ุชุฃุฏ ฺฉุฏ 6 ุฑูู OTP  

## ๐ ุฑูุน ูุดฺฉูุงุช ุงุญุชูุงู

### ูุดฺฉู 1: reCAPTCHA ูุณุฏูุฏ ูโุดูุฏ

**ุนูุช**: Firebase reCAPTCHA ุฏุฑ ูุญุท localhost ฺฏุงู ูุณุฏูุฏ ูโุดูุฏ

**ุฑุงู ุญู**:
- ูุทูุฆู ุดูุฏ ฺฉู ุฏุงููู `localhost` ุฏุฑ Firebase Console ุซุจุช ุดุฏู ุงุณุช
- ุง ุงุฒ ุฏุงูููโูุง ูุฌุงุฒ Firebase ุงุณุชูุงุฏู ฺฉูุฏ: `snabb-82415.web.app`

### ูุดฺฉู 2: OTP ุงุฑุณุงู ููโุดูุฏ

**ุนูุช**: ูุดฺฉู ุฏุฑ ฺฉุงููฺฏ Firebase ุง ูุญุฏูุฏุช ูุฑุฎ

**ุฑุงู ุญู**:
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู API Key ุตุญุญ ุงุณุช
- ูุทูุฆู ุดูุฏ ฺฉู Firebase project ูุนุงู ุงุณุช
- ุงุฒ ุดูุงุฑูโูุง ุชุณุช Firebase ุงุณุชูุงุฏู ฺฉูุฏ

### ูุดฺฉู 3: ฺฉุฏ OTP ูุงุฏุฑุณุช ุงุณุช

**ุนูุช**: ฺฉุฏ ูุงุฑุฏ ุดุฏู ุจุง ฺฉุฏ Firebase ูุทุงุจูุช ูุฏุงุฑุฏ

**ุฑุงู ุญู**:
- ุจุฑุง ุดูุงุฑูโูุง ุชุณุช Firebaseุ ุญุชูุงู `123456` ุฑุง ูุงุฑุฏ ฺฉูุฏ
- ุจุฑุง ุดูุงุฑูโูุง ูุงูุนุ ฺฉุฏ ุฏุฑุงูุช ุงุฒ SMS ุฑุง ูุงุฑุฏ ฺฉูุฏ

## ๐ฑ ุงุณุชูุงุฏู ุฏุฑ Production

ุจุฑุง ุงุณุชูุงุฏู ุฏุฑ ูุญุท production:

1. **ุงุถุงูู ฺฉุฑุฏู ุฏุงููู ุจู Firebase Console**:
   - Settings โ Authorized domains
   - ุงุถุงูู ฺฉุฑุฏู ุฏุงููู production

2. **ุบุฑูุนุงู ฺฉุฑุฏู ุดูุงุฑูโูุง ุชุณุช**:
   - Authentication โ Phone โ Test phone numbers
   - ุญุฐู ุง ุบุฑูุนุงู ฺฉุฑุฏู ุดูุงุฑูโูุง ุชุณุช

3. **ุชูุธู rate limiting**:
   - ุจุฑุฑุณ quota ู rate limits ุฏุฑ Firebase Console

## ๐ ูุถุนุช ฺฉููู

โ ูพุงุฏูโุณุงุฒ Firebase Auth: **ฺฉุงูู**  
โ ุตูุญู Login: **ฺฉุงูู**  
โ Context Provider: **ฺฉุงูู**  
โ reCAPTCHA Integration: **ฺฉุงูู**  
โ ุขูุงุฏู ุจุฑุง ุชุณุช ุฏุณุช: **ุจูู**  

## ๐ฏ ูุฑุญูู ุจุนุฏ

ุจุนุฏ ุงุฒ ุชุฃุฏ ููููุชโุขูุฒ ูุฑูุฏ ุจุง Firebase ุฏุฑ ูุณุฎู ูุจ Driver App:
- ูโุชูุงู ููู ููุทู ุฑุง ุฏุฑ ุงูพูฺฉุดู ููุจุงู (React Native) ูพุงุฏูโุณุงุฒ ฺฉุฑุฏ
- ูโุชูุงู ููู ุณุณุชู ุฑุง ุจุฑุง ุงูพูฺฉุดู Passenger ูุฒ ุงุณุชูุงุฏู ฺฉุฑุฏ
